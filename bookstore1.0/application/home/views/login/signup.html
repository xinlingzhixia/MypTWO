<!DOCTYPE html>
<html>
<!-- Head -->
<head>
    <title>注册表单</title>
    <!-- Meta-Tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script type="application/x-javascript"> addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);

    function hideURLbar() {
        window.scrollTo(0, 1);
    } </script>
    <!-- //Meta-Tags -->
    <script type="text/javascript" src="<?php echo __LOGIN_JS__;?>jquery-1.11.1.min.js"></script>
    <!-- Style -->
    <link rel="stylesheet" href="<?php echo __LOGIN_CSS__;?>style.css" type="text/css" media="all">
</head>
<!-- //Head -->
<!-- Body -->
<body>
<!--<h1>注册表单</h1>-->
<div class="container" style="margin-top: 180px;">
    <div class="">
        <h2>注 册</h2>
        <form action="#" method="post" id="regform" class="fh5co-form animate-box" data-animate-effect="fadeIn">
            <!--点回来还原成英文 ，.focus聚焦(function ()-->
            <div class="form-group">
                <div class="alert alert-success" id="alertmess" role="alert">Your info has been saved.</div>
            </div>
            <input type="text" name="uname" class="form-control" id="uname" autocomplete="off" placeholder="用户名">
            <input type="text" name="uemail" class="form-control" id="uemail" autocomplete="off" placeholder="邮箱"
                   required="">
            <input type="password" name="upwd" class="form-control" id="upwd" placeholder="密码" autocomplete="off">
            <input type="password" class="form-control" name="reupwd" id="reupwd" placeholder="确认密码" autocomplete="off">
        </form>
        <div class="form-group">
            <p> 已经注册?&nbsp&nbsp<a href="index.php?g=home&c=login&a=index"> 登 陆 </a></p>
        </div>
        <div class="send-button w3layouts agileits">
            <form>
                <input type="submit" id="sub" name="sub" value="免费注册">
            </form>
        </div>
        <div class="clear"></div>
    </div>

    <div class="clear"></div>

</div>

<div class="footer w3layouts agileits">
    <p>Copyright &copy; More Templates <a href="http://www.cssmoban.com/" target="_blank" title="万图书城">万图书城</a> -
        Collect from <a href="http://www.cssmoban.com/" title="万图书城" target="_blank">万图书城</a></p>
</div>
//表单ajax提交
<!--<script type="text/javascript">-->

/**表单客户端验证*/
<!--function checkName() {-->
<!--var flag = false;//默认-->
<!--$("#uname").blur(function () {-->
<!--var str1 = /^[0-9a-z]{5,}|_[0-9a-z]{5,}$/i;-->
<!--if ($(this).val() == "") {-->
<!--$("#alertmess").html("用户名不允许为空！");-->
<!--} else if (str1.test($(this).val()) == false) {-->
<!--$("#alertmess").html("用户名必须是6位以上的数字字母下划线！");-->
<!--} else {-->
<!--$.post(-->
<!--'index.php?g=home&c=user&a=checkuser',-->
<!--{"uname": $(this).val()},-->
<!--function (result) {-->
<!--if (result == 1) {-->
<!--$("#alertmess").html("用户名已经被占用！");-->
<!--} else {-->
<!--$("#alertmess").html("用户名可用！");-->
<!--flag = true;-->
<!--}-->
<!--}-->
<!--);-->
<!--}-->
<!--}-->
<!--).focus(function () {-->
<!--$("#alertmess").html("Your info has been saved.");-->
<!--});-->
<!--if ($("#uname").val() != "") {-->
<!--flag = true;-->
<!--}-->
<!--return flag;-->
<!--}-->

<!--/**验证邮箱*/-->
<!--function checkEmail() {-->
<!--var flag = false;//默认-->
<!--$("#uemail").blur(function () {-->
<!--var str2=/^[a-zA-Z0-9_\.\-]+\@(([a-zA-Z0-9\-]+\.)+([a-zA-Z0-9]{2,4})+$/;-->
<!--if ($(this).val() == "") {-->
<!--$("#alertmess").html("邮箱不允许为空！");-->
<!--} else if (str2.test($(this).val())==false) {-->
<!--$("#alertmess").html("您的电子邮件格式不正确");-->
<!--flag = true;-->
<!--}else {-->
<!--$("#alertmess").html("电子邮件可以使用");-->
<!--flag = true;-->
<!--}-->
<!--}).focus(function () {-->
<!--$("#alertmess").html("Your info has been saved.");-->
<!--});-->

<!--if ($("#uemail").val() != "") {-->
<!--flag = true;-->
<!--}-->
<!--return flag;-->
<!--}-->

<!--/**密码验证*/-->
<!--function checkPwd() {-->
<!--var flag = false;//默认-->
<!--$("#upwd").blur(function () {-->
<!--var str3 = /^(\d|[A-z0-9]{4,10}$/;-->
<!--if ($(this).val() == "") {-->
<!--$("#alertmess").html("密码不允许为空！");-->
<!--} else if (str3.test($(this).val())==false) {-->
<!--$("#alertmess").html("mima为6-14位数字或字母！");-->
<!--}else{-->
<!--$("#alertmess").html("密码可以使用！");-->
<!--flag = true;-->
<!--}-->
<!--}).focus(function () {-->
<!--$("#alertmess").html("Your info has been saved.");-->
<!--});-->
<!--if ($("#upwd").val() != "") {-->
<!--flag = true;-->
<!--}-->
<!--return flag;-->
<!--}-->

<!--/**两次输入密码是否一致验证*/-->
<!--function checkRePwd() {-->
<!--var flag = false;//默认-->
<!--$("#reupwd").blur(function () {-->
<!--if ($(this).val() == "") {-->
<!--$("#alertmess").html("确认密码不允许为空！");-->
<!--} else {-->
<!--flag = true;-->
<!--}-->
<!--if ($(this).val() != $("#upwd").val()) {-->
<!--$("#alertmess").html("两次密码不一致！");-->
<!--}-->
<!--}).focus(function () {-->
<!--$("#alertmess").html("Your info has been saved.");-->
<!--});-->

<!--if ($("#upwd").val() == $("#reupwd").val()) {-->
<!--flag = true;-->
<!--}-->

<!--return flag;-->
<!--}-->

<!--//确认密码-->
<!--function chakrepwd() {-->
<!--var $repwd = $("#repwd").val();-->
<!--var $pwd = $("#pwd").val();-->
<!--if ($repwd == null || $repwd == "") {-->
<!--$("#repwd_prompt").html("确认密码不能为空");-->
<!--return false;-->
<!--} else if ($pwd == $repwd) {-->
<!--$("#repwd_prompt").html("可以使用")-->
<!--return false;-->
<!--} else {-->
<!--$("#repwd_prompt").html("两次密码不一致")-->
<!--return false;-->
<!--}-->
<!--}-->

<!--$(function () {-->
<!--checkName();-->
<!--checkEmail();-->
<!--checkPwd();-->
<!--checkRePwd();-->

<!--点击提交按钮-->
<!--$("#sub").click(function () {-->
<!--if (checkName() && checkEmail() && checkPwd() && checkRePwd()) {-->
<!--$.post(-->
<!--'index.php?g=home&c=user&a=register',-->
<!--$("#regform").serialize(),-->
<!--function (result) {-->
<!--if (result.errno == 200) {-->
<!--alert(result.mess + "\n点击确认后进入登录页面");-->
<!--window.location.href = "index.php?g=home&c=login&a=index";-->
<!--} else {-->
<!--$("#alertmess").html(result.mess);-->
<!--}-->
<!--},-->
<!--"json"-->
<!--);-->
<!--$("#regform")[0].reset();-->
<!--} else {-->
<!--$("#alertmess").html("注册失败！");-->
<!--}-->
<!--return false;-->
<!--});-->
<!--})-->


/***********************************************************************************/


<!--表单ajax提交-->
<script type="text/javascript">
    //用户名验证
    function checkName() {
        var flag = false;//默认
        $("#uname").blur(function () {
            var str1 = /^[0-9a-z]{5,}|_[0-9a-z]{5,}$/i;
            if ($(this).val() == "") {
                $("#alertmess").html("用户名不允许为空！");
            } else if (str1.test($(this).val()) == false) {
                $("#alertmess").html("用户名必须是6位以上的数字字母下划线！");
            } else {
                $.post(
                    'index.php?g=home&c=user&a=checkuser',
                    {"uname": $(this).val()},
                    function (result) {
                        if (result == 1) {
                            $("#alertmess").html("用户名已经被占用！");
                        } else {
                            $("#alertmess").html("用户名可用！");
                            flag = true;
                        }
                    }
                );
            }
        }).focus(function () {
            $("#alertmess").html("Your info has been saved.");
        });
        if ($("#uname").val() != "") {
            flag = true;
        }
        return flag;
    }

    /**验证邮箱*/
    function checkEmail() {
        var flag = false;//默认
        $("#uemail").blur(function () {
            var str2 = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if ($(this).val() == "") {
                $("#alertmess").html("邮箱不允许为空！");
            } else if (str2.test($(this).val()) == false) {
                $("#alertmess").html("您的电子邮件格式不正确");
            } else {
                $("#alertmess").html("电子邮件可以使用");
                flag = true;
            }
        }).focus(function () {
            $("#alertmess").html("Your info has been saved.");
        });

        if ($("#uemail").val() != "") {
            flag = true;
        }
        return flag;
    }

    /**密码验证*/
    function checkPwd() {
        var flag = false;//默认
        $("#upwd").blur(function () {
            var str3 = /^(\d|[a-zA-Z]){6,14}$/;
            if ($(this).val() == "") {
                $("#alertmess").html("密码不允许为空！");
            } else if (str3.test($(this).val()) == false) {
                $("#alertmess").html("密码为6-14位数字或字母！");
            } else {
                $("#alertmess").html("密码可以使用！");
                flag = true;

            }
        }).focus(function () {
            $("#alertmess").html("Your info has been saved.");
        });
        if ($("#upwd").val() != "") {
            flag = true;
        }
        return flag;
    }

    /**两次输入密码是否一致验证*/
    function checkRePwd() {
        var flag = false;//默认
        $("#reupwd").blur(function () {
            if ($(this).val() == "") {
                $("#alertmess").html("确认密码不允许为空！");
            } else {
                flag = true;
            }
            if ($(this).val() != $("#upwd").val()) {
                $("#alertmess").html("两次密码不一致！");
            }
        }).focus(function () {
            $("#alertmess").html("Your info has been saved.");
        });

        if ($("#upwd").val() == $("#reupwd").val()) {
            flag = true;
        }
        return flag;
    }

    //验证手机号码
    // function checkPhone() {
    //     var flag = false;//默认
    //     $("#uphone").blur(function () {
    //         var str4 = /^1[3|4|5|7|8][0-9]\d{4,8}$/i;
    //         if ($(this).val() == "") {
    //             $("#alertmess").html("手机号码不允许为空！");
    //         } else if (str4.test($(this).val()) == false) {
    //             $("#alertmess").html("手机号码格式不正确！");
    //         } else {
    //             $("#alertmess").html("手机号码可以使用！");
    //             flag = true;
    //         }
    //     }).focus(function () {
    //         $("#alertmess").html("Your info has been saved.");
    //     });
    //
    //     if ($("#uphone").val() != "") {
    //         flag = true;
    //     }
    //     return flag;
    // }

    //验证密钥
    // function checkKey() {
    //     var flag = false;//默认
    //     $("#ukey").blur(function () {
    //         if ($(this).val() == "") {
    //             $("#alertmess").html("密钥不允许为空！");
    //         } else {
    //             $("#alertmess").html("密钥可以使用！");
    //             flag = true;
    //         }
    //     }).focus(function () {
    //         $("#alertmess").html("Your info has been saved.");
    //     });
    //
    //     if ($("#ukey").val() != "") {
    //         flag = true;
    //     }
    //     return flag;
    // }


    $(function () {
        checkName();
        checkEmail();
        checkPwd();
        checkRePwd();
        // checkPhone();
        // checkKey();

        //点击提交按钮
        $("#sub").click(function () {
            if (checkName() && checkEmail() && checkPwd() && checkRePwd()) {
                $.post(
                    'index.php?g=home&c=user&a=register',
                    $("#regform").serialize(),
                    function (result) {
                        if (result.errno == 200) {
                            alert(result.mess + "\n点击确认后进入登录页面");
                            window.location.href = "index.php?g=home&c=login&a=index";
                        } else {
                            $("#alertmess").html(result.mess);
                        }
                    },
                    "json"
                );
                $("#regform")[0].reset();
                // } else {
                //     $("#alertmess").html("注册失败！");
            }
            return false;
        });
    })
</script>
</body>
</html>